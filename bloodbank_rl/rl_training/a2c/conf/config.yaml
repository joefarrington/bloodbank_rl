hydra:
  run:
    dir: .
  output_subdir: ./tmp_logs/hydra_output/${now:%Y-%m-%d}/${now:%H-%M-%S}
hydra_logdir: ${hydra:output_subdir}
device: cuda
env:
  _target_: bloodbank_rl.environments.platelet_bankSR.PlateletBankGym
  demand_provider: 
    _target_: bloodbank_rl.environments.platelet_bankSR.PoissonDemandProviderSR
    sim_duration: 365
    one_hot_encode_weekday: True
  max_order: 60
  max_shelf_life: 3
  lead_time: 0
  shelf_life_at_arrival_dist: [0,0,1]
  fixed_order_cost: 225
  variable_order_cost: 650
  holding_cost: 130
  emergency_procurement_cost: 3250
  wastage_cost: 650
vec_env:
  n_train_envs: 3
  train_env_seed: [15, 16, 17]
  n_test_envs: 1
  test_env_seed: 12
actor_network:
  _target_: tianshou.utils.net.common.Net
  hidden_sizes: [128, 128, 128]
  device: ${device}
critic_network:
  _target_: tianshou.utils.net.common.Net
  hidden_sizes: [128, 128, 128]
  device: ${device}
optimiser:
  _target_: torch.optim.RMSprop
  lr: 1e-4
  eps: 1e-5
  alpha: 0.99
policy:
  _target_: bloodbank_rl.tianshou_utils.policies.A2CPolicyforMLFlow
  discount_factor: 0.75
  gae_lambda: 0.5
  max_grad_norm: 0.5
  deterministic_eval: True
  reward_normalization: True
  ent_coef: 0.01
train_collector:
  _target_: tianshou.data.Collector
  buffer:
    _target_: tianshou.data.VectorReplayBuffer
    total_size: ${trainer.step_per_collect}
    buffer_num: ${vec_env.n_train_envs}
  exploration_noise: True
test_collector:
  _target_: tianshou.data.Collector
  exploration_noise: True
logger:
  _target_: bloodbank_rl.tianshou_utils.logging.TianshouMLFlowLogger
  filename: train_a2c.py
  experiment_name: a2c_tianshou
  info_logger:
    _target_: bloodbank_rl.tianshou_utils.logging.InfoLogger
checkpoints:
  save_checkpoints: True
  path: ./tmp_logs/model_checkpoints/${now:%Y-%m-%d}/${now:%H-%M-%S}
  training_checkpoint_interval: 1
trainer:
  _target_: tianshou.trainer.onpolicy_trainer
  max_epoch: 50
  step_per_epoch: 10000
  repeat_per_collect: 1
  episode_per_test: 100
  batch_size: 9999
  step_per_collect: 15
  test_in_train: False
seed: 57